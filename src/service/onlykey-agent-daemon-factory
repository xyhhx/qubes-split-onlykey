#!/bin/bash
set -aeo pipefail

handle_sig(){
  systemd-notify --status "Exiting" \
    && sleep 3 \
    && exit 0

}

trap handle_sig SIGHUP SIGINT SIGQUIT

[[ -z "${OK_CLIENT_DOMAIN}" && -z "${LISTEN_FDS}" ]] \
  && echo "No remote to work with" \
  && exit 1


# systemctl --user start "onlykey-agent-daemon@$(systemd-escape "${OK_CLIENT_DOMAIN}").socket"

systemd-notify --status "Started a daemon for ${OK_CLIENT_DOMAIN}"

